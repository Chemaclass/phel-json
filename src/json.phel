(ns mabasic\json\json)

(defn- phel-to-php [x]
    (cond
        (or (table? x) (struct? x) (array? x) (tuple? x) (set? x))
            (let [a (php/array)]
                (foreach [k v x]
                    (php/aset a (phel-to-php k) (phel-to-php v)))
                a)
        (symbol? x) (str (php/-> x (getName)))
        (keyword? x) (str (php/-> x (getName)))
        (float? x) (str x)
        true x))

(defn encode [v]
    (php/json_encode (phel-to-php v)))